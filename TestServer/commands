To create a new spreadsheet file on the server, the client should send
CREATE LF
Name:name LF
Password:password LF

If the server successfully created the new spreadsheet file, it should respond with
CREATE SP OK LF
Name:name LF
Password:password LF

Otherwise, it should respond with
CREATE SP FAIL LF
Name:name LF
message LF


To begin working on an existing spreadsheet on the server, the client should send
JOIN LF
Name:name LF
Password:password LF

If the request succeeded, the server should respond with
JOIN SP OK LF
Name:name LF
Version:version LF
Length:length LF
xml LF

Otherwise, the server should respond with
JOIN SP FAIL LF
Name:name LF
message LF


To change the contents of a cell in a spreadsheet, the client should send
CHANGE LF
Name:name LF
Version:version LF
Cell:cell LF
Length:length LF
content LF

If the request succeeded, the server should respond with
CHANGE SP OK LF
Name:name LF
Version:version LF

For any other error, the server should respond with
CHANGE SP FAIL LF
Name:name LF
message LF


To undo the last change made to a spreadsheet, the client should send
UNDO LF
Name:name LF
Version:version LF

If the request succeeded, the server should respond with
UNDO SP OK LF
Name:name LF
Version:version LF
Cell:cell LF
Length:length LF
content LF

If there are no unsaved changes, the server should respond with
UNDO SP END LF
Name:name LF
Version:version LF

If the clientâ€™s version is out of date, the server should respond with
UNDO SP WAIT LF
Name:name LF
Version:version LF

For any other error, the server should respond with
UNDO SP FAIL LF
Name:name LF
message LF


To communicate a committed change to other clients, the server should send
UPDATE LF
Name:name LF
Version:version LF
Cell:cell LF
Length:length LF
content LF


To save the current state of the spreadsheet and merge all outstanding changes to the existing
file, the client should send to the server
SAVE LF
Name:name LF

If the request succeeds, the server should respond with
SAVE SP OK LF
Name:name LF

If the request fails, the server should respond with
SAVE SP FAIL LF
Name:name LF
message LF

To leave a spreadsheet, the client should send
LEAVE LF
Name:name LF


If the server receives a message from a client that does not follow one of the expected message
formats, it responds with
ERROR LF





